# AIFlash - Baseline

[è‹±æ–‡è¯´æ˜ (English)](README.md)

---

## ğŸ‡¨ğŸ‡³ ä¸­æ–‡
åŸºäº [Restormer](https://github.com/swz30/Restormer) æ”¹è¿›çš„AIé—ªå…‰äººåƒ Baseline ä»£ç ã€‚

### ğŸ¯ æŒ‘æˆ˜åŠ¨æœº

å°½ç®¡æ·±åº¦å­¦ä¹ åœ¨å›¾åƒæ¢å¤é¢†åŸŸå–å¾—äº†æ˜¾è‘—è¿›å±•ï¼Œä½†åœ¨çœŸå®ä¸–ç•Œçš„æš—å…‰äººåƒåœºæ™¯ä¸­ï¼Œç°æœ‰æ¨¡å‹ä»éš¾ä»¥å…¼é¡¾å™ªå£°å»é™¤ã€ç»†èŠ‚ä¿ç•™ã€å…‰å½±ä¸è‰²å½©è¿˜åŸã€‚**AI é—ªå…‰äººåƒ**æ—¨åœ¨ç”Ÿæˆè‡ªç„¶ã€å¹²å‡€ã€çœŸå®çš„äººåƒï¼ŒåŒæ—¶ä¿æŒèƒŒæ™¯è§‚æ„Ÿèˆ’é€‚ã€è‰²å½©å‡†ç¡®ã€‚

### ğŸ† æŒ‘æˆ˜ç›®æ ‡

æœ¬æ¬¡æŒ‘æˆ˜èµ›æ—¨åœ¨ä¸ºå·¥ä¸šä¸å­¦æœ¯å‚ä¸è€…æä¾›å¹³å°ï¼Œåœ¨çœŸå®ä¸–ç•Œæˆåƒåœºæ™¯ä¸­æµ‹è¯•å’Œè¯„ä¼°ç®—æ³•ä¸æ¨¡å‹ã€‚æŒ‘æˆ˜ç›®æ ‡åŒ…æ‹¬ï¼š

- å»ºç«‹çœŸå®åœºæ™¯æš—å…‰äººåƒæ¢å¤è¯„æµ‹åŸºå‡†ï¼Œè¦†ç›–å®¢è§‚ä¸ä¸»è§‚è¯„ä»·ï¼›
- æ¨åŠ¨é«˜é²æ£’æ€§ç®—æ³•çš„ç ”å‘ä¸è½åœ°åº”ç”¨ï¼›
- é¼“åŠ±äººåƒä¸åœºæ™¯æ•´ä½“è´¨é‡å…¼ä¼˜çš„è§£å†³æ–¹æ¡ˆã€‚

---

### âš ï¸ æ•°æ®è¯´æ˜

| æ•°æ® | åˆ†è¾¨ç‡ |
|------|--------|
| è¾“å…¥å›¾åƒ (Input) | **1K** |
| çœŸå€¼å›¾åƒ (GT) | **1K** |
| æäº¤ç»“æœ | **1K** |

> **æ³¨æ„**ï¼šå½“å‰ Baseline è®­ç»ƒæ—¶å°†å›¾åƒ resize åˆ° **768** è¿›è¡Œè®­ç»ƒï¼Œé€‰æ‰‹å¯æ ¹æ®è‡ªå·±çš„æ˜¾å­˜æƒ…å†µè°ƒæ•´è®­ç»ƒåˆ†è¾¨ç‡ã€‚æœ€ç»ˆæäº¤çš„æ¨ç†ç»“æœå¿…é¡»ä¸º **1K åˆ†è¾¨ç‡**ã€‚

---


### ğŸ“¥ æ•°æ®é›†ä¸‹è½½

è¯·æ ¹æ®ä¸åŒé˜¶æ®µä¸‹è½½å¯¹åº”æ•°æ®é›†ï¼š

| é˜¶æ®µ | æ•°æ®é›† | ä¸‹è½½é“¾æ¥ | è¯´æ˜ |
|------|--------|----------|------|
| ç¬¬ä¸€é˜¶æ®µ | è®­ç»ƒé›† | [å¾…å®š]() | è®­ç»ƒå›¾åƒï¼ˆè¾“å…¥ + GT é…å¯¹ + äººåƒæ©ç ï¼‰ |
| ç¬¬äºŒé˜¶æ®µ | æµ‹è¯•é›† A | ğŸ”’ æœªå¼€å¯ | æµ‹è¯•å›¾åƒï¼ˆæ—  GTï¼‰ |
| ç¬¬ä¸‰é˜¶æ®µ | æµ‹è¯•é›† B | ğŸ”’ æœªå¼€å¯ | æµ‹è¯•å›¾åƒï¼ˆæ—  GTï¼‰ |

#### ç›®å½•ç»“æ„

ä¸‹è½½åï¼Œè¯·æŒ‰ä»¥ä¸‹ç»“æ„ç»„ç»‡æ•°æ®ï¼š

```
AI_Flash-BaseLine/
â”œâ”€â”€ datasets/
â”‚   â”œâ”€â”€ train/
â”‚   â”‚   â”œâ”€â”€ input/          # è®­ç»ƒè¾“å…¥å›¾åƒï¼ˆæš—å…‰ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ 0001.jpg
â”‚   â”‚   â”‚   â”œâ”€â”€ 0002.jpg
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ gt/             # è®­ç»ƒçœŸå€¼å›¾åƒ
â”‚   â”‚   â”‚   â”œâ”€â”€ 0001.jpg
â”‚   â”‚   â”‚   â”œâ”€â”€ 0002.jpg
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â””â”€â”€ mask_personmask/    # äººåƒåˆ†å‰²æ©ç ï¼ˆå¦‚ä½¿ç”¨ï¼‰
â”‚   â”‚       â”œâ”€â”€ 0001.jpg
â”‚   â”‚       â”œâ”€â”€ 0002.jpg
â”‚   â”‚       â””â”€â”€ ...
â”‚   â””â”€â”€ test/
â”‚       â”œâ”€â”€ input/          # æµ‹è¯•è¾“å…¥å›¾åƒ
â”‚       â”‚   â”œâ”€â”€ 0001.jpg
â”‚       â”‚   â”œâ”€â”€ 0002.jpg
â”‚       â”‚   â””â”€â”€ ...
â”‚       â””â”€â”€ mask_personmask/    # äººåƒåˆ†å‰²æ©ç ï¼ˆå¦‚ä½¿ç”¨ï¼‰
â”‚           â”œâ”€â”€ 0001.jpg
â”‚           â”œâ”€â”€ 0002.jpg
â”‚           â””â”€â”€ ...
â”œâ”€â”€ configs/
â”œâ”€â”€ basicsr/
â””â”€â”€ ...
```

---


### ç¯å¢ƒå®‰è£…

#### 1. åˆ›å»º Conda ç¯å¢ƒ

```bash
conda create -n aiflash python=3.10 -y
conda activate aiflash
```

#### 2. å®‰è£… PyTorch (CUDA 12.1)

```bash
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
```

> å…¶ä»– CUDA ç‰ˆæœ¬è¯·å‚è€ƒ [PyTorch å®˜ç½‘](https://pytorch.org/get-started/locally/)

#### 3. å®‰è£…å…¶ä»–ä¾èµ–

```bash
pip install matplotlib scikit-learn scikit-image opencv-python yacs joblib natsort h5py tqdm
pip install einops gdown addict future lmdb "numpy<2" pyyaml requests scipy tensorboard yapf lpips
```

#### 4. å®‰è£… BasicSR

```bash
cd AI_Flash-BaseLine
pip install -e .
```

---

### è®­ç»ƒ

```bash
python basicsr/train.py -opt configs/flash.yaml
```

---

### æ¨ç†

```bash
python inference.py \
    --config configs/flash.yaml \
    --weights pth/net_g_xxx.pth \
    --input_dir test/input \
    --output_dir test/output
```

#### æ¨ç†å‚æ•°è¯´æ˜

| å‚æ•° | å¿…å¡« | è¯´æ˜ |
|------|------|------|
| `--config` | âœ… | YAML é…ç½®æ–‡ä»¶è·¯å¾„ |
| `--weights` | âœ… | æ¨¡å‹æƒé‡æ–‡ä»¶è·¯å¾„ |
| `--input_dir` | âœ… | è¾“å…¥å›¾åƒç›®å½•æˆ–å•å¼ å›¾ç‰‡ |
| `--output_dir` | âŒ | è¾“å‡ºç›®å½•ï¼Œé»˜è®¤ `./results` |
| `--tile` | âŒ | åˆ†å—å¤§å°ï¼Œç”¨äºå¤§å›¾æ¨ç† |
| `--tile_overlap` | âŒ | åˆ†å—é‡å ï¼Œé»˜è®¤ 32 |

---

### è‡´è°¢

æœ¬ä»£ç åŸºäº [Restormer](https://github.com/swz30/Restormer) ä¿®æ”¹ã€‚
```bibtex
@inproceedings{Zamir2021Restormer,
    title={Restormer: Efficient Transformer for High-Resolution Image Restoration}, 
    author={Syed Waqas Zamir and Aditya Arora and Salman Khan and Munawar Hayat 
            and Fahad Shahbaz Khan and Ming-Hsuan Yang},
    booktitle={CVPR},
    year={2022}
}
```
